# Конфигурация агентов для ReAct Main Agent
# Main Agent имеет доступ к специализированным субагентам (tools)

# =============================================================================
# АГЕНТЫ (TOOLS)
# =============================================================================

agents:
  - id: products
    name: Products Agent
    description: Эксперт по БАДам, микродозингу грибов, биохакингу, рецептам и привычкам
    tool_name: products_agent
    enabled: true
    # База знаний (будет использоваться в Phase 6)
    google_docs:
      - https://docs.google.com/document/d/10UelJwksL3T57zC4vGvgjyq_ePlzr_e7HdmJgciM3Wk/edit?tab=t.0#heading=h.9bduimapb6r3
    # Топики для RAG индексации
    topics:
      - БАДы и добавки
      - Дозировки и схемы приёма
      - Микродозинг грибов
      - Курс биохакинга
      - Рецепты и привычки

  - id: compatibility
    name: Compatibility Agent
    description: Эксперт по сочетаемости БАДов между собой и анализу взаимодействий
    tool_name: compatibility_agent
    enabled: true
    # База знаний (будет использоваться в Phase 7)
    google_docs:
      - https://docs.google.com/document/d/121TlSVzWpb4JkArsiUSnwxO1F07YPLJwaE1tettaxWs/edit?tab=t.gzqntu9ney49#heading=h.mkkf48j5v03f
    topics:
      - Совместимость БАДов
      - Синергетические эффекты
      - Опасные комбинации
      - Рекомендации по сочетанию

  - id: marketing
    name: Marketing Agent
    description: Эксперт по маркетингу, генерации баннеров и анализу целевой аудитории
    tool_name: marketing_agent
    enabled: true
    # Пока без базы знаний (использует MCP tools)
    google_docs: []
    # MCP инструменты (будут подключены в Phase 8)
    mcp_tools:
      - banner_generator
      - audience_analyzer
    topics:
      - Генерация баннеров
      - Анализ ЦА
      - Маркетинговые стратегии
      - Брендинг

# =============================================================================
# НАСТРОЙКИ MAIN AGENT
# =============================================================================

main_agent: 
  # Максимальное количество итераций ReAct цикла
  max_iterations: 10
  
  # Таймаут на выполнение одного запроса (секунды)
  timeout: 60

# =============================================================================
# НАСТРОЙКИ СУБАГЕНТОВ
# =============================================================================

subagents:
  # LLM модель для субагентов (может быть другой моделью, чем Main Agent)
  llm_model: "openai:gpt-5.2"
  
  # Окно истории диалога (количество последних сообщений)
  history_window: 10
  
  # Разрешить параллельные вызовы субагентов
  # (пока не поддерживается в create_react_agent, reserved для будущего)
  allow_parallel: false
  
  # Максимальное количество субагентов в одном запросе
  max_per_request: 3
  
  # Таймаут на вызов одного субагента (секунды)
  timeout: 30
  
  # Настройки для Products Subagent
  products:
    domain: "products"
    rag_min_score: 0.3  # Понижен для лучшего recall
    enabled: true

  # Настройки для Compatibility Subagent
  compatibility:
    domain: "compatibility"
    rag_min_score: 0.3  # Понижен (было 0.6, слишком строго)
    enabled: true
    
  # Настройки для Marketing Subagent
  marketing:
    enabled: false  # Заглушка, будет включено в Phase 8
    # Будущие настройки:
    # mcp_tools:
    #   - banner_generator
    #   - audience_analyzer
    #   - content_strategy

# =============================================================================
# RAG НАСТРОЙКИ (для будущих фаз)
# =============================================================================

rag:
  # Hybrid search: веса для dense/sparse
  # dense_weight - вес векторного поиска (семантика, смысл)
  # sparse_weight - вес полнотекстового поиска (ключевые слова)
  dense_weight: 0.7
  sparse_weight: 0.3
  
  # Multi-query search параметры
  # top_k_per_query - сколько результатов брать на каждый подзапрос
  # final_top_k - итоговое количество после merge всех подзапросов
  top_k_per_query: 5
  final_top_k: 15
  
  # Reranker (Cross-Encoder для улучшения качества результатов)
  # use_reranker - включить/выключить reranking (если false, модель не загружается)
  use_reranker: true
  
  # NOTE: min_score фильтр настраивается индивидуально для каждого субагента
  # в секции subagents (см. rag_min_score)

# =============================================================================
# OFF-TOPIC HANDLING
# =============================================================================

off_topic:
  # Темы для сообщения об off-topic запросах
  available_topics:
    - "БАДы и добавки (дозировки, схемы приёма, рекомендации)"
    - "Сочетаемость продуктов (что можно комбинировать, синергия)"
    - "Маркетинг (создание баннеров, анализ ЦА, стратегии)"
  
  # Шаблон сообщения (если нужно переопределить дефолтный из промпта)
  custom_message: null
